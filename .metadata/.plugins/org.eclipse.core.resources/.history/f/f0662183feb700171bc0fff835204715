package probability;

import java.util.ArrayList;
import java.util.Random;

public class Primes {
	
	public ArrayList printPrimesSimple(){
		ArrayList lists = new ArrayList();
		for(int j = 2; j<10000;j++){
			int flag = 1;
			for(int i=2; i<=(int)Math.sqrt(j);i++){
				if(j%i==0){
					flag = 0;
					break;
				}
			}
			if(flag==1){
				lists.add(j);
			}
		}
		return lists;
	}
	public ArrayList printPrimes(){
		System.out.println(2);
		System.out.println(3);
		int n = 5;
		ArrayList lists = new ArrayList();
		lists.add(2);
		lists.add(3);
		lists.add(5);
		do{
			if(repeatMillRab(n, (int)(Math.log(n)/Math.log(2)))==true){
				System.out.println(n);
				lists.add(n);
			}
			n = n+2;
		}while(n<10000);
		return lists;
	}
	
	public boolean repeatMillRab(int n, int b){
		for(int i = 1; i<=b; i++){
			if(millRob(n)==false){
				return false;
			}
		}
		return true;
	}
	
	public boolean millRob(int n){
		Random rand= new Random();
		int a = rand.nextInt(n);
		a = 2 + a*(n-2-2)/n;
		return Btest(a, n);
	}
	
	public boolean Btest(int a, int n){
		int s = 0;
		int t = n-1;
		do{
			s++;
			t /= 2;
		}while(t%2!=1);
		
		int x = modularExponent(a, t, n);
		if(x==1||x==n-1){
			return true;
		}
		for(int i= 1; i<=s-1;i++){
			x = (x*x)%n;
			if(x==n-1){
				return true;
			}
		}
		return false;
	}
	
	public int modularExponent(int a, int t, int n){
		int s = 1;
		while(t>0){
			if(odd(t)){
				s = (s*a)%n;
			}
			a = (a*a)%n;
			t = t/2;
		}
		return s;
	}
	
	public boolean odd(int t){
		if(t%2==0){
			return false;
		}else{
			return true;
		}
	}
	
	public static void main(String[] args){
		Primes p = new Primes();
//		ArrayList temp1 = new ArrayList();
//		ArrayList temp2 = new ArrayList();
//		temp1 = p.printPrimes();
//		temp2 = p.printPrimesSimple();
//		System.out.println("the size of lists"+temp2.size());
		System.out.println(p.Btest(158, 289));
	}
}
